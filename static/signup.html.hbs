{{#*inline "title"}}Sign Up - CodeQuest{{/inline}}

{{#*inline "body"}}
    <h1>Create an Account</h1>

    <form id="signup-form" class="form-box" method="POST" action="/signup">
        <div id="error-box" class="error" style="display:none;"></div>

        <label>Username</label>
        <input type="text" name="username" autoFocus required>

        <label>Password</label>
        <input type="password" name="password" required>

        <button type="submit" class="submit-btn accent">Sign Up</button>
    </form>

    <script>
    document.getElementById("signup-form").addEventListener("submit", async (e) => {
        e.preventDefault(); // stop normal form submission

        const form = e.target;
        const formData = new FormData(form);

        const response = await fetch("/signup", {
            method: "POST",
            body: formData,
            credentials: "include",
        });

        const data = await response.json();

        if (data.success) {
            window.location.href = data.redirect;
            return;
        } else {
            const errorText = data.error;
            const errorBox = document.getElementById("error-box");
            errorBox.textContent = errorText || "Unknown error.";
            errorBox.style.display = "block";
            return;
        }
    });
    </script>
{{/inline}}

{{> base user=user }}
